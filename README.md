## –ß—Ç–æ —ç—Ç–æ?
–≠—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è, –∫–∞–∫ –∑–∞–≤–µ—Å—Ç–∏ —Å–≤–æ–π VPN/VPS. –ß—Ç–æ–±—ã –Ω–µ –∑–∞–±—ã—Ç—å –∏ –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å.
–í—Å–µ —à–∞–≥–∏ –≤—Ä—É—á–Ω—É—é, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ - —Å–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π VPN + –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è "–∫–æ–Ω—Å–æ–ª—å" –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
Disclaimer - —Å–∞–º –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –ø—Ä–æ–±—É—é, –µ—Å–ª–∏ —á—Ç–æ –Ω–µ —Ç–∞–∫, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å.

## —à–∞–≥-1 - –∑–∞–≤–æ–¥–∏–º —Å–µ–±–µ –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è (—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –¥–æ–º–µ–Ω)
–≠—Ç–æ—Ç —à–∞–≥ —Å duckdns –Ω–µ –æ—á–µ–Ω—å –Ω—É–∂–µ–Ω, —Ç.–∫. wireguard –≤–µ–∑–¥–µ —Ö—Ä–∞–Ω–∏—Ç ip –∞–¥—Ä–µ—Å–∞, –∞ –Ω–µ –∏–º–µ–Ω–∞. –ü–æ–ª—É—á–∞–µ—Ç—Å—è, —á—Ç–æ –∏–º—è –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞, —á—Ç–æ–±—ã ip-—à–Ω–∏–∫–∏ –Ω–µ —É—á–∏—Ç—å.

duckdns.org - –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –Ø –∑–∞—Ä–µ–≥–∞–ª—Å—è –æ—Ç –≥—É–≥–ª–∞.

–Ω–∞–¥–æ –ø—Ä–∏–¥—É–º–∞—Ç—å –∏–º—è –ø–æ–¥-–¥–æ–º–µ–Ω–∞. –ù—É –Ω–µ –ø–æ ip-—à–Ω–∏–∫—É –∂–µ –∑–∞—Ö–æ–¥–∏—Ç—å!

![ducksns 1st pic](/images/photo_2022-04-09_22-00-32.jpg)

–í–Ω–∏–º–∞–Ω–∏–µ! duckdns –ø—Ä–∏—Å–ª–∞–ª —Ç–æ–∫–µ–Ω –≤ –ø–∏—Å—å–º–µ. –¢–æ–∫–µ–Ω –±—É–¥–µ—Ç –Ω—É–∂–µ–Ω –ø–æ—Ç–æ–º –≤ —Å–∫—Ä–∏–ø—Ç–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

## —à–∞–≥-2 - –∑–∞–≤–µ—Å—Ç–∏ VPS. 
–Ø –±—Ä–∞–ª https://vdsina.ru. –ù—É–∂–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –Ω–∞–¥–æ –∑–∞–∫–∏–Ω—É—Ç—å —Ç—É–¥–∞ —á—É—Ç—å –¥–µ–Ω–µ–≥. –Ø –ø–æ–ª–æ–∂–∏–ª 350 —Ä—É–±–ª–µ–π, –∫–æ–º–∏—Å—Å–∏—è –±—ã–ª–∞ 10 —Å –∫–æ–ø–µ–π–∫–∞–º–∏. –°–µ—Ä–≤–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –±—ã—Å—Ç—Ä–æ, –∞ –≤–æ—Ç –ø–∏—Å—å–º–∞ –≤ –≥—É–≥–ª (e-mail —è —É–∫–∞–∑–∞–ª –æ—Ç—Ç—É–¥–∞) –∏–¥—É—Ç –º–µ–¥–ª–µ–Ω–Ω–µ–µ.

![vps 1st pic](/images/photo_2022-04-09_21-44-29.jpg)

- —Ç—É—Ç –ø—Ä–æ—Å—Ç–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–∞–º—ã–π –¥–µ—à–µ–≤—ã–π. –≠—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è VPN. –ü–æ—Ç–æ–º –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞–¥–æ.


![vps 2st pic](/images/photo_2022-04-09_21-45-20.jpg)

–®–∞–≥–∏ –ø–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–≤–æ–∂—É, –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ. –ù—É –∏–ª–∏ –ø–æ—Ç–æ–º.
vsdina –¥–∞—ë—Ç –æ–¥–∏–Ω —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ipv4 –∞–¥—Ä–µ—Å, —Ç–∞–∫ —á—Ç–æ –ø–æ —Å—É—Ç–∏ dyn-dns –Ω–∞–º –Ω–µ –Ω–∞–¥–æ, –Ω–æ –≤—Å—ë —Ä–∞–≤–Ω–æ —Å–¥–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç, —á—Ç–æ–±—ã –∞–¥—Ä–µ—Å "–æ–±–Ω–æ–≤–ª—è–ª—Å—è" –∏ duckdns –Ω–µ –ø—Ä–æ—Ç—É—Ö–∞–ª.

–ö–æ–≥–¥–∞ —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω (–Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç), –ø—Ä–∏–¥—ë—Ç –ø–∏—Å—å–º–æ —Å IP –∞–¥—Ä–µ—Å–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º —Ä—É—Ç–∞. –Ø –ø–∞—Ä–æ–ª—å —Å—Ä–∞–∑—É —Å–º–µ–Ω–∏–ª, –Ω–æ, –≤–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –∏ –Ω–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ, —Ç.–∫. –∏–∑ web-–∫–æ–Ω—Å–æ–ª–∏ vdsina —ç—Ç–æ —Ç–æ–∂–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –∑–∞–±—ã–ª–∏.

–ë—É–¥–µ–º –∑–∞—Ö–æ–¥–∏—Ç—å –æ—Ç –Ω–µ–≥–æ –∏ —Å—Ç–∞–≤–∏—Ç—å-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë. 

–ù–µ –±–æ–π—Ç–µ—Å—å –æ—à–∏–±–æ–∫ - —Ö–æ—Å—Ç–∏–Ω–≥ –ø–æ–∑–≤–æ–ª—è–µ—Ç 

–∞) —Ä–µ—Å–µ—Ç–Ω—É—Ç—å —Å–µ—Ä–≤–µ—Ä, 

–±) –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –µ–≥–æ. –ü—Ä–∏ —á—ë–º, —è —Ç–∞–∫ –ø–æ–Ω—è–ª, —á—Ç–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –∏–ª–∏ –Ω–µ–¥–æ—Ä–æ–≥–æ. –¢–∞–∫ —á—Ç–æ, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥—ë—Ç –Ω–µ —Ç–∞–∫, —Ç–æ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –Ω–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞. –£ –º–µ–Ω—è –ø–æ–ª—É—á–∏–ª–æ—Å—å —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞.

–≤) —Å vdsina –º–æ–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –ø–∞—Ä–æ–ª—å —Ä—É—Ç–∞ –∏ –∑–∞–π—Ç–∏ –≤ vnc. –ü–æ–∫–∞ –Ω–µ –±—ã–ª–æ –Ω—É–∂–Ω–æ, –Ω–æ –ø—Ä–æ–±–æ–≤–∞–ª, —Ä–∞–±–æ—Ç–∞–µ—Ç.
–°–†–ê–ó–£! –ù–∏–∫–∞–∫–∏—Ö —Å–ª–∞–±—ã—Ö –ø–∞—Ä–æ–ª–µ–π! –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ - –±—ã–ª–æ –±—ã –∑–¥–æ—Ä–æ–≤–æ –ø—Ä–æ–ø–∏—Å–∞—Ç—å, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –≤—Ö–æ–¥ –ø–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—É... –ù–æ —è —ç—Ç–æ–≥–æ –Ω–µ –¥–µ–ª–∞–ª. –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–∞–±–∏—Ä–∞—Ç—å —Å–≤–æ–π –ø–∞—Ä–æ–ª—å —É–∂–µ –Ω–∞–¥–æ–µ–¥–∞–µ—Ç... –û–¥–Ω–∞–∫–æ, –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–æ–∏–ª –∏ –±–æ–ª—å—à–µ —Ç—É–¥–∞ –Ω–µ —Ö–æ–∂—É.

## —à–∞–≥ 3 - –Ω–∞—á–∏–Ω–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å
1. –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –º–µ–Ω—è–µ–º –ø–∞—Ä–æ–ª—å —Ä—É—Ç–∞
```
adduser  username
```
  –î–µ–ª–∞–µ–º –µ–≥–æ sudo
```
usermod -aG sudo username
```
–õ–æ–≥–∏–Ω–∏–º—Å—è –∫–∞–∫ username, –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —É –Ω–µ–≥–æ –µ—Å—Ç—å sudo. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –æ—Ç–∫–ª—é—á–∞—Ç—å—Å—è –æ—Ç —Ä—É—Ç–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ, —á—Ç–æ –Ω–æ–≤—ã–π account —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ!
  
–ú–µ–Ω—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø–∞—Ä–æ–ª—å —É —Ä—É—Ç–∞ –∏ –æ—Ç–ª–æ–≥–∏–Ω–∏–≤–∞–µ–º—Å—è –æ—Ç –Ω–µ–≥–æ.
```
passwd
```
  
## —à–∞–≥ 4 - –°—Ç–∞–≤–∏–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ wireguard 
Taken mostly from here: https://www.wireguard.com/install/
```
sudo apt install wireguard
```
## —à–∞–≥ 5 - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã - —Ä–æ—É—Ç–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –≤ —è–¥—Ä–µ
```
sudo vi /etc/sysctl.conf
```
(–∫–æ–º—É –Ω—Ä–∞–≤–∏—Ç—Å—è - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ nano, –∫–æ–Ω–µ—á–Ω–æ!)

–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞/—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞:
```
net.ipv4.ip_forward = 1
```
- –Ø —Å–¥–µ–ª–∞–ª —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É. –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–µ —Å—Ç–∞–ª (–ø–æ–∫–∞). –í–æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ
```
net.ipv6.conf.default.forwarding = 1
net.ipv6.conf.all.forwarding = 1
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.proxy_arp = 0
net.ipv4.conf.default.send_redirects = 1
net.ipv4.conf.all.send_redirects = 0
```  
Then apply the new option with the command below.
```
sudo sysctl -p
```
–ø—Ä–∏ —ç—Ç–æ–º –Ω–∞ —ç–∫—Ä–∞–Ω–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å.

net.ipv4.ip_forward=1
  
## —à–∞–≥ 6 - –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ duckdns
```
sudo su
mkdir /root/duckdns
vi /root/duckdns/duck.sh
```
Add a line
```
echo url="https://www.duckdns.org/update?domains=–í–ê–®–ü–û–î–î–û–ú–ï–ù.duckdns.org&token=–¢–û–ö–ï–ù–û–¢DUCKDNS" | curl -k -o ~/duckdns/duck.log -K -
```
save the file
```
chmod +x /root/duckdns/duck.sh          
```
–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –µ–≥–æ
```
.\duck.sh
```
–í–Ω–µ–∑–∞–ø–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–ª–æ—Å—å, —á—Ç–æ –Ω–∞ vps –Ω–µ—Ç—É curl, –¥–æ–±–∞–≤–ª—è–µ–º
```
sudo apt update
apt install curl
```
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–∞–¥–æ –µ–≥–æ –∑–∞—à–µ–¥—É–ª–∏—Ç—å
```
crontab -e
```
Add a line (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ dyndns –∞–¥—Ä–µ—Å–∞ —Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç)
```
*/5 * * * * ~/duckdns/duck.sh >/dev/null 2>&1
```
(–Ø –ø–æ—Ç–æ–º –ø–æ–º–µ–Ω—è–ª –Ω–∞ —Ä–∞–∑ –≤ 30 –º–∏–Ω—É—Ç, —Ç—É—Ç –Ω–∏—á–µ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ). –ï—Å–ª–∏ —Ç–µ–ø–µ—Ä—å –∑–∞–π—Ç–∏ –Ω–∞ duckdns –≤ —Å–≤–æ–π –∞–∫–∫, —Ç–æ —Ç–∞–º –±—É–¥–µ—Ç –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ vps. –ù—É –∏ –Ω–∞ vps —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—Ö–æ–¥–∏—Ç—å –ø–æ –∏–º–µ–Ω–∏, –∞ –Ω–µ –ø–æ ip.

## —à–∞–≥ 7 - –ó–∞—â–∏—Ç–∞ firewall-–æ–º, –µ—Å–ª–∏ –Ω–µ—Ç—É. ufw - –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–¥ iptables
—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–∞–π—Ä–≤–æ–ª ubuntu - iptables —É–∂–µ —Å—Ç–æ–∏—Ç. –ù–æ –∏–º —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–ª–æ–∂–Ω–æ. –°—Ç–∞–≤–∏–º –Ω–∞–¥—Å—Ç—Ä–æ–π–∫—É
```
sudo apt install ufw
```  
–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏–º –µ—ë
```
sudo ufw allow ssh
sudo ufw allow 8189/udp
sudo ufw allow from 192.168.2.0/24
sudo ufw allow from wg0
sudo ufw default deny incoming
sudo ufw default allow outgoing
ufw default allow routed
```
–≤–∫–ª—é—á–∞–µ–º —Ñ–∞–π—Ä–≤–æ–ª
```
sudo ufw enable
sudo ufw status
```
Logging

ufw –∏ iptables –æ—á–µ–Ω—å –±–æ–ª—Ç–ª–∏–≤—ã. –Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –±—ã–≤–∞–µ—Ç –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É tail -f /var/log/–∏–º—è–õ–æ–≥–∞, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, —á—Ç–æ —Ç–∞–º –±—ã–ª–æ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ, –ø–æ–ª—É—á–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä—è–º–æ –ø–æ —Ö–æ–¥—É –¥–µ–ª–∞.
  
To enable logging use:
```
sudo ufw logging on
```
To disable logging use (–∏–Ω–∞—á–µ –∫–∞–∂–¥—ã–π –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç –ø–∏—à–µ—Ç—Å—è –≤ /var/log/syslog)
```  
sudo ufw logging off
```
–ú—ã —Ä–∞–∑—Ä–µ—à–∏–ª–∏ –≤—Ö–æ–¥ —Ç–æ–ª—å–∫–æ —á—Ä–µ–∑–µ 22–π –ø–æ—Ä—Ç. 

–ü–æ-–∏–¥–µ–µ –º–æ–∂–Ω–æ –µ—â—ë —Ä–∞–∑—Ä–µ—à–∏—Ç—å 5000 –¥–ª—è —Å–≤–æ–µ–≥–æ IP-—à–Ω–∏–∫–∞, —Ö–æ—Ç—è –±—ã –≤—Ä–µ–º–µ–Ω–Ω–æ, —á—Ç–æ–±—ã –∑–∞–π—Ç–∏ –Ω–∞ WG-GUI. 

–Ø –ø–æ-–Ω–µ–∑–Ω–∞–Ω–∏—é –≤—Å—ë –¥–µ–ª–∞–ª –≤—Ä—É—á–Ω—É—é, –∞ –ø–æ—Ç–æ–º —É–∂–µ –∑–∞—à–µ–ª —á–µ—Ä–µ–∑ –≥—É–π –∏ —Å—Ç—Ä–∞–¥–∞–ª, —á—Ç–æ —Ç–∞–∫ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –±—ã–ª–æ –º–æ–∂–Ω–æ.–ê –ø–æ—Ç–æ–º —É–∂–µ —Ö–æ–¥–∏–ª —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∫–ª–∏–µ–Ω—Ç–∞.

–ö–∞–∫ –±—ã —è —Å–¥–µ–ª–∞–ª —Å–µ–π—á–∞—Å? –í–æ–æ–±—â–µ, –¥—É–º–∞—é, –ø–æ—Ä—Ç 22 —Å—Ç–æ–∏–ª–æ –±—ã –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –∏ –Ω–∞ –Ω–µ–≥–æ —Ö–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ web ui vdsina.

## —à–∞–≥ 8 - Install ui for wg remote management 
(if firewall set as said above, it will be available only from VPN.)

–≠—Ç–∞ —É–¥–æ–±–Ω–∞—è —à—Ç—É–∫–∞ - –º—ã –Ω–µ –±—É–¥–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—å WG –∫–ª–∏–µ–Ω—Ç–æ–≤ —Ä—É–∫–∞–º–∏. –î–∞ –∏ —Å–∞–º —Å–µ—Ä–≤–µ—Ä —Ç–æ–∂–µ. –ê —Ç–æ —è –≤–Ω–∞—á–∞–ª–µ –∑–∞–¥–æ–ª–±–∞–ª—Å—è –∫–ª—é—á–∏ —Ç—É–¥–∞-—Å—é–¥–∞ –≤—Å—Ç–∞–≤–ª—è—Ç—å. –≥—É–π –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É –ê–¥—Ä–µ—Å–°–µ—Ä–≤–µ—Ä–∞:5000, –ª–æ–≥–∏–Ω admin/admin

–ì—É–π –Ω–∞–π–¥–µ–Ω –∑–¥–µ—Å—å:
  https://github.com/ngoduykhanh/wireguard-ui
  https://github.com/ngoduykhanh/wireguard-ui/releases

```
sudo su
cd /etc/wireguard
wget https://github.com/ngoduykhanh/wireguard-ui/releases/download/v0.3.6/wireguard-ui-v0.3.6-linux-386.tar.gz
  
tar -xzf wireguard‚Ä¶
```
–†–∞—Å–ø–∞–∫–æ–≤–∞–ª–∏

–º–æ–∂–Ω–æ —Å–∫–∞—á–∞–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ —É–¥–∞–ª–∏—Ç—å. –£–∂–µ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≥—É–π —á–µ—Ä–µ–∑ ./scriptname –∏ –ø–æ–∏–≥—Ä–∞—Ç—å, –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–º, —á—Ç–æ–±—ã –æ–Ω —Å–∞–º –∑–∞–ø—É—Å–∫–∞–ª—Å—è.


## —à–∞–≥ 9 - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º wg web ui for remote mgmt
### Create monitoring part for restarting wg service on change
–Ω—É–∂–µ–Ω —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º wg –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å wg
```
vi /etc/systemd/system/wgui.service
```
–í—Å—Ç–∞–≤–ª—è–µ–º
```
[Unit]
Description=Restart WireGuard
After=network.target
[Service]
Type=oneshot
ExecStart=/usr/bin/systemctl restart wg-quick@wg0.service
[Install]
RequiredBy=wgui.path
```
–µ—â—ë –æ–¥–∏–Ω —Ñ–∞–π–ª
```
vi /etc/systemd/system/wgui.path
```
–≤—Å—Ç–∞–≤–ª—è–µ–º
```
[Unit]
Description=Watch /etc/wireguard/wg0.conf for changes
[Path]
PathModified=/etc/wireguard/wg0.conf
[Install]
WantedBy=multi-user.target
```  
–°–µ—Ä–≤–∏—Å –Ω–µ —Å—Ç–∞—Ä—Ç–∞–Ω—ë—Ç, –µ—Å–ª–∏ –Ω–µ —Å–æ–∑–¥–∞—Ç—å —Ö–æ—Ç—è –±—ã –ø—É—Å—Ç–æ–π cfg file (sudo su, –∫–æ–Ω–µ—á–Ω–æ –∂–µ)
```
touch /etc/wireguard/wg0.conf
```
Apply it
```
systemctl enable wgui.{path,service}
systemctl start wgui.{path,service}
```  
  
### Run wireguard-ui as a service. 
–í–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∞–π—Ç wg ui –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω —Ç–æ–ª—å–∫–æ –∏–∑–Ω—É—Ç—Ä–∏ firewall.
```
vi /etc/systemd/system/wireguard-ui.service
```
–≤—Å—Ç–∞–≤–ª—è–µ–º
```
[Unit]
Description=Wireguard-UI web site
After=network.target
  
[Service]
Type=simple
WorkingDirectory=/etc/wireguard
ExecStart=/etc/wireguard/wireguard-ui
Restart=always
RestartSec=10
  
[Install]
WantedBy=multi-user.target
```  
Apply it
```
systemctl enable wireguard-ui
systemctl start wireguard-ui
```

## –®–∞–≥ 10 - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ—Å—Ç–∞—Ä—Ç–∞ wg –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```
sudo systemctl start wg-quick@wg0
sudo systemctl enable wg-quick@wg0
```
## –®–∞–≥ 11 - –∑–∞—â–∏—Ç–∞ –ø–æ—Ä—Ç–∞ 22 –æ—Ç –≤–∑–ª–æ–º–∞
```
sudo apt-get install fail2ban
```  
To configure fail2ban, make a 'local' copy the jail.conf file in /etc/fail2ban 
```  
cd /etc/fail2ban
sudo cp jail.conf jail.local 
```  
Now edit the file: 
```  
sudo vi jail.local 
```
–Ω–∞–¥–æ –∏–≥–æ–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–∏ –∞–¥—Ä–µ—Å–∞.

1) –ª–æ–∫–∞–ª—Ö–æ—Å—Ç ipv4 –∏ ipv6 (–≤—Ç–æ—Ä–æ–µ - –ø–æ –∏–Ω–µ—Ä—Ü–∏–∏)

2) –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∞–¥—Ä–µ—Å VPN. –í–Ω–∏–º–∞–Ω–µ, —ç—Ç–æ –ù–ï –∞–¥—Ä–µ—Å –¥–æ–º–∞—à–Ω–µ–π —Å–µ—Ç–∏, –Ω–µ –∞–¥—Ä–µ—Å —Ä–∞–±–æ—á–µ–π, —ç—Ç–æ —Å–≤–æ—è —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Å–µ—Ç—å. –î–∞–π—Ç–µ –µ–π —Ç–∞–∫–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–∏ —Å —á–µ–º –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞–ª–∞—Å—å.

3) —è –¥–æ–±–∞–≤–∏–ª —Ç–µ –∞–¥—Ä–µ—Å–∞, —Å –∫–æ—Ç–æ—Ä—ã—Ö —è –±—É–¥—É –∑–∞—Ö–æ–¥–∏—Ç—å —Å–∞–º

–¥–æ–±–∞–≤–ª—è–µ–º
```     
ignoreip = 127.0.0.1/8 ::1 192.168.2.1/24 37.1.83.168 109.195.115.122
```
- Localhost + office + home + vpn
  
Set the IPs you want fail2ban to ignore, the ban time (in seconds) and maximum number of user attempts to your liking: 
```  
  [DEFAULT]
# "ignoreip" can be an IP address, a CIDR mask or a DNS host
ignoreip = 127.0.0.1
bantime  = 3600
maxretry = 3 
```  
–ú–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è
bantime  = 36000
```  
# A host is banned if it has generated "maxretry" during the last "findtime"
# seconds.
findtime  = 10m
  
# "maxretry" is the number of failures before a host get banned.
maxretry = 3
```  
–ò –Ω–∞–¥–æ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å fail2ban —á—Ç–æ–±—ã –æ–Ω –∑–∞—Ä–∞–±–æ—Ç–∞–ª
```
sudo /etc/init.d/fail2ban restart 
```  
  From <https://help.ubuntu.com/community/Fail2ban>

–ì—É–π –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏ –¥–æ fail2ban. –ù–æ fail2ban - must have, –µ—Å–ª–∏ —É –Ω–∞—Å "–≤ —Å–µ—Ç—å" —Ç–æ—Ä—á–∏—Ç 22–π –ø–æ—Ä—Ç. –í –ª–æ–≥–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –ø–æ–∫–∞ —è fail2ban –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª, –ø—Ä–æ—Å—Ç–æ—è–Ω–Ω–æ –≤–∞–ª–∏–ª–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —é–∑–µ—Ä–µ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–∞—Ä–æ–ª–µ.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç—é—Ä—å–º—ã ssh (—Ñ–∞–π–ª /etc/fail2ban/jail.local)
```
#
# JAILS
#

#
# SSH servers
#

[sshd]

# To use more aggressive sshd modes set filter parameter "mode" in jail.local:
# normal (default), ddos, extra or aggressive (combines all).
# See "tests/files/logs/sshd" or "filter.d/sshd.conf" for usage example and details.
#mode   = normal
enabled = true
port    = ssh
filter  = sshd
maxretry = 2
logpath = %(sshd_log)s
backend = %(sshd_backend)s
```
–Ω–µ –∑–∞–±—ã–≤–∞–µ–º —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø–æ—Å–ª–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```
sudo systemctl restart fail2ban
sudo systemctl status fail2ban
```
–∏ –µ—â—ë –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ç–∞–º —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
```
fail2ban-client status sshd
```

## –®–∞–≥ 12 - –≥—É–π
–ó–∞—Ö–æ–¥–∏–º –Ω–∞ –ø–æ—Ä—Ç 5000 –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ admin/admin

![–∑–∞—Ö–æ–¥–∏–º –≤ global settings](/images/photo_2022-04-09_23-14-59.jpg)

–°–µ—Ä–≤–µ—Ä—É –Ω–∞–¥–æ –∑–Ω–∞—Ç—å —Å–≤–æ–π –≤–Ω–µ—à–Ω–∏–π ip –∞–¥—Ä–µ—Å

–Ø –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –≤–≤–æ–¥–∏–ª –ø–æ–ª–Ω–æ–µ –∏–º—è —Å–ª–æ–≤–∞–º–∏, –≥—É–π (—Å—ã—Ä–æ–≤–∞—Ç) –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ ipv4

–¢–µ–ø–µ—Ä—å –≥–µ–Ω–µ—Ä–∏–º –∫–ª—é—á–∏ —Å–µ—Ä–≤–µ—Ä–∞

![–≥–µ–Ω–µ—Ä–∏–º –∫–ª—é—á–∏ —Å–µ—Ä–≤–µ—Ä–∞ - –ü—Ä–∏–≤–∞—Ç–Ω–∏–∫ –∏ –ø—É–±–ª–∏–∫](/images/photo_2022-04-09_23-17-40.jpg)

–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–ª—è–µ–º —Å–∫—Ä–∏–ø—Ç—ã PostUp and PostDown
```
Post Up
iptables -t nat -A POSTROUTING -o ens3 -j MASQUERADE; ip6tables -t nat -A POSTROUTING -o ens3 -j MASQUERADE
Post Down
iptables -t nat -D POSTROUTING -o ens3 -j MASQUERADE; ip6tables -t nat -D POSTROUTING -o ens3 -j MASQUERADE
```
–¢—É—Ç –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ: –∏–º—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ens3 –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –µ–≥–æ —É–≤–∏–¥–µ—Ç—å, –Ω–∞–¥–æ –Ω–∞–±—Ä–∞—Ç—å –≤ ssh –∫–æ–º–∏–Ω–¥—É
```
ip a
```
–ò–º—è –∑–¥–µ—Å—å:

![check interface name](/images/photo_2022-04-09_23-20-16.jpg)

–°–æ–∑–¥–∞—ë–º –∫–ª–∏–µ–Ω—Ç–æ–≤

![–∑–¥–µ—Å—å –∂–µ —Å–æ–∑–¥–∞—ë–º –∫–ª–∏–µ–Ω—Ç–æ–≤](/images/photo_2022-04-09_23-20-51.jpg)

–ù–µ –∑–∞–±—ã–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—è—Ç—å.

–ò —Ç—É—Ç —è –Ω–∞–ª–µ—Ç–µ–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ —É–∂–µ –∏–∑-–∑–∞ —Å–∫–ª–µ—Ä–æ–∑–∞ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞–¥–æ –Ω–∞–∂–∏–º–∞—Ç—å –∫–Ω–æ–ø–∫—É apply configuration –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

![apply](/images/photo_2022-04-09_23-24-43.jpg)

–ö–ª–∏–µ–Ω—Ç—É –Ω–∞ –ê–Ω–¥—Ä–æ–∏–¥–µ –∏ –ê–π—Ñ–æ–Ω–µ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫—É qr-code, –∏ —É –Ω–∏—Ö –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç

![scan](/images/photo_2022-04-09_23-26-12.jpg)


–ú–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ download. –≠—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤ –∏ —Ä–æ—É—Ç–µ—Ä–æ–≤.

–í–Ω–∏–º–∞–Ω–∏–µ, –≤ —Ñ–∞–π–ª–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á. –ë–µ—Ä–µ–≥–∏—Ç–µ –µ–≥–æ, –Ω–µ –Ω–∞–¥–æ –ø—Ä–æ—Å—Ç–æ —Ç–∞–∫ –≤–µ–∑–¥–µ –µ–≥–æ —Ö—Ä–∞–Ω–∏—Ç—å, –ª—É—á—à–µ –≤ –¥—Ä—É–≥–æ–π —Ä–∞–∑ —Å–∫–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ —Å —Å–µ—Ä–≤–µ—Ä–∞.

## –í–∏–Ω–¥–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç
https://www.wireguard.com/install/

- –≤ –Ω–µ–≥–æ –Ω–∞–¥–æ –ø—Ä–æ—Å—Ç–æ "–ø–æ–¥–≥—Ä—É–∑–∏—Ç—å" –µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è.

–û—Å—Ç–æ—Ä–æ–∂–Ω–æ. –Ø "–ø–æ–¥–∫–ª—é—á–∏–ª" —Å–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä, –∫–æ–≥–¥–∞ –∑–∞—à–µ–ª –≤ –Ω–µ–≥–æ —É–¥–∞–ª—ë–Ω–Ω–æ. –ö–æ–Ω–µ—á–Ω–æ, —è –µ–≥–æ —Ç—É—Ç –∂–µ –∏ –ø–æ—Ç–µ—Ä—è–ª –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –¥–æ–±—Ä–∞–ª—Å—è –¥–æ –Ω–µ–≥–æ –ø–µ—à–∫–æ–º.

–ö–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∑–∞–∫–æ–Ω–Ω–µ–∫—Ç–∏–ª—Å—è (–∏ –Ω–∞ –∞–Ω–¥—Ä–æ–∏–¥–µ, –∏ –Ω–∞ ios, –∏ –Ω–∞ –≤–∏–Ω–¥–µ) - —É –Ω–µ–≥–æ —Ç–∏–∫–∞—é—Ç –æ–±–∞ —Å—á—ë—Ç—á–∏–∫–∞, –∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö, –∏ –ø—Ä–∏–Ω—è—Ç—ã—Ö –±–∞–π—Ç

![sample](/images/photo_2022-04-09_23-29-51.jpg)

## Keenetik

–¥–æ–±–∞–≤–∏—Ç—å WG, –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –≤ –Ω–µ–≥–æ CFG —Ñ–∞–π–ª –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç.

![component](/images/photo_2022-04-10_00-04-32.jpg)

–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

![config](/images/photo_2022-04-10_00-05-02.jpg)

–ò–º—è Connection –∏ –ø–∏—Ä–∞ –∫–∏–Ω–µ—Ç–∏–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–∞–º–æ–º—É

–í–∫–ª—é—á–∏—Ç—å –Ω–µ –∑–∞–±—ã–≤–∞–µ–º

![turn on](/images/photo_2022-04-10_00-05-47.jpg)

–ù–∞–¥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

![priority](/images/photo_2022-04-10_00-06-22.jpg)

![priority2](/images/photo_2022-04-10_00-06-51.jpg)

–£ –º–µ–Ω—è –æ–Ω –∑–∞—Ä–∞–±–æ—Ç–∞–ª, –∫–æ–≥–¥–∞ —è –µ–º—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç–∞–≤–∏–ª

![priority3](/images/photo_2022-04-10_00-07-26.jpg)

–ò –µ—â—ë –≤–æ—Ç —ç—Ç—É –≥–∞–ª–æ—á–∫—É –Ω–∞ WG –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —Ç–æ–∂–µ –Ω–∞–¥–æ –∫–ª–∏–∫–Ω—É—Ç—å.

## –ß—Ç–æ –º–æ–∂–µ—Ç –ø–æ–π—Ç–∏ –Ω–µ —Ç–∞–∫

1) –ø–æ–º–µ–Ω—è—Ç—å –ø–∞—Ä–æ–ª—å —Ä—É—Ç–∞ –∏–ª–∏ —Å–µ–±—è –∏ –∑–∞–±—ã—Ç—å –µ–≥–æ. –ü—Ä–∏–¥—ë—Ç—Å—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä.
2) –∑–∞–±–ª–æ—á–∏—Ç—å —Ñ–∞–π—Ä–≤–æ–ª–æ–º –¥–æ—Å—Ç—É–ø –∏ –Ω–µ —Å–º–æ—á—å –≤–æ–π—Ç–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.
3) —É –º–µ–Ω—è "–ø–æ–ª—É—á–∞–ª–æ—Å—å" –ø—ã—Ç–∞—Ç—å—Å—è –≤–æ–π—Ç–∏, –Ω–µ –∑–∞–ø—É—Å—Ç–∏–≤ VPN. 
- —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ WG (–≤ ssh)
```
wg show
```
- –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç-—Å—Ç–æ–ø (–±–µ–∑ —Å–µ—Ä–≤–∏—Å–∞)  SSH –ø—Ä–∏ —ç—Ç–æ–º –æ—Ç–≤–∞–ª–∏–≤–∞–µ—Ç—Å—è! –ï—Å–ª–∏ –Ω–µ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä—ë–Ω –∫–ª–∏–µ–Ω—Ç, –º–æ–∂–Ω–æ –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è!
```
wg-quick up wg0
wg-quick down wg0
```
- —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
```
systemctl status wg0 wg-quick@wg0
```
4) "—Ö–æ—Ä–æ—à–∞—è" –∏–¥–µ—è - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å VPN –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ, –µ—Å–ª–∏ —Ç–∞–º –Ω–∏–∫–æ–≥–æ –Ω–µ—Ç. –í—ã –≤–∫–ª—é—á–∞–µ—Ç–µ VPN –∫–ª–∏–µ–Ω—Ç–∞ –∏ –≤—Å—ë. –í–æ–π—Ç–∏ –≤ —ç—Ç–æ—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ. –í–ø—Ä–æ—á–µ–º, —Å —Ä–æ—É—Ç–µ—Ä–æ–º —Ç–æ –∂–µ - –º–æ–∂–Ω–æ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –ø–æ—Ç–µ—Ä—è—Ç—å —Å–µ—Ç—å. –ò –∫ –≤–∞–º –ø—Ä–∏–¥—É—Ç –≤—ã—è—Å–Ω—è—Ç—å, –∫—É–¥–∞ –¥–µ–ª—Å—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç üòä


5) –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ VPN –Ω–∞ –∫–∏–Ω–µ—Ç–∏–∫–µ —Å —É—á—ë—Ç–æ–º –ø–æ—Å–ª–µ–¥–Ω–µ–π –≥–∞–ª–æ—á–∫–∏ (Use for accessing the internet) —É –≤–∞—Å –º–µ–Ω—è–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π IP-—à–Ω–∏–∫ –∏ —á—Ç–æ-—Ç–æ –º–æ–∂–µ—Ç –æ—Ç—Ä—É–±–∏—Ç—å—Å—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–ª–∏–µ–Ω—Ç –∫–∏–Ω–æ–ø–æ–∏—Å–∫–∞ "–ø–æ—Ç–µ—Ä—è–ª" –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é.
–ü–æ-–∏–¥–µ–µ —Ç—É—Ç –º–æ–∂–Ω–æ –ø–æ–∏–≥—Ä–∞—Ç—å –∫–æ–º–∞–Ω–¥–∞–º–∏ —Ä–æ—É—Ç–∏–Ω–≥–∞, –Ω–æ —è –Ω–µ —Ä–∞–∑–±–∏—Ä–∞–ª—Å—è –µ—â—ë.


## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ firwall.
–µ—â—ë –æ–¥–Ω–æ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —è —á—É—Ç—å –Ω–µ –∑–∞–±—ã–ª. –ù–æ —è –Ω–µ –Ω–∞ 100% —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –æ–Ω–æ –Ω—É–∂–Ω–æ. 

- –ø–æ–∑–≤–æ–ª–∏—Ç—å —Ä–æ—É—Ç–∏–Ω–≥ –æ—Ç –≤–∞–π—Ä–≥–∞—Ä–¥–æ–≤—Å–∫–æ–≥–æ –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
```
ufw route allow in on wg0 out on ens3
```
- –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª —Ä–æ—É—Ç–∏–Ω–≥–∞ –≤ ufw
```
vi /etc/ufw/sysctl.conf:
```
—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏
```
net/ipv4/ip_forward=1
net/ipv6/conf/default/forwarding=1
net/ipv6/conf/all/forwarding=1
```
–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å.
```
ufw disable
ufw enable
```
–ø–æ—á–µ–º—É –Ω–µ —É–≤–µ—Ä–µ–Ω: –ø–æ—Ö–æ–∂–µ, —ç—Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–µ–ª–∞–µ—Ç Post Up –ø—Ä–∞–≤–∏–ª–æ —Å–∞–º–æ–≥–æ WG Server.

### –∞–ª—å—Ç–µ—Ä—Ç–∞–Ω–∏–≤–Ω—ã–π WireGuard client. 
https://tunsafe.com

–í –ê–Ω–¥—Ä–æ–∏–¥–µ —É –Ω–µ–≥–æ –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ—Ç –Ω–µ–≥–æ –æ—Ç–∫–ª—é—á–∏—Ç—å (–ø–æ-—É–º–æ–ª—á–∞–Ω–∏—é –≤—Å–µ –≤–∫–ª—é—á–µ–Ω—ã) (—Ä–∞–±–æ—Ç–∞–µ—Ç, —è –ø—Ä–æ–≤–µ—Ä—è–ª, –∏—Å–∫–ª—é—á–∞—è FireFox - –ø—Ä–∏ —ç—Ç–æ–º –ø–µ—Ä–µ—Å—Ç–∞–ª –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è —Å–∞–π—Ç bbc . com.)

–û–±—â–∞—è –∏–¥–µ—è - –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ–º—É –Ω–∞–¥–æ, –∏–¥—É—Ç —á–µ—Ä–µ–∑ –í–ü–ù, –¥—Ä—É–≥–∏–µ - –Ω–∞–ø—Ä—è–º—É—é. –ù–µ–∫–æ—Ç–æ—Ä—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º "–º–æ–µ–≥–æ –¥–æ–º–∞—à–Ω–µ–≥–æ" –≤–ø–Ω —ç—Ç–æ –æ—á–µ–Ω—å –Ω–∞–¥–æ.

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ –≤ —Ä–æ–¥–Ω–æ–º –∫–ª–∏–µ–Ω—Ç–µ - —á–µ—Ä–µ–∑ –∫–∞—Ä—Ç–∏–Ω–∫—É.

### –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö (–∏ –¥—Ä—É–≥–∏—Ö –Ω–µ-VPN) –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ AllowedIPs

–ï—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö (–∏–ª–∏ —Ç–µ—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—á–µ—Ç—Å—è) –∞–¥—Ä–µ—Å–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ wireguard. –ù–µ—É–¥–æ–±–Ω–æ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. –û—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –µ—Å–ª–∏ WG —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Ä–∞–±–æ—Ç–µ - –∫–∞–∫ —Ä–∞–∑ —Ä–∞–±–æ—á–∏–µ –∞–¥—Ä–µ—Å–∞ –º–æ–∂–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –∏ —Ç–æ–≥–¥–∞ –µ—Å–ª–∏ –∫–æ–º–ø –∑–∞–ª–æ—á–∏—Ç—Å—è, —Ç–æ –¥–æ–º–µ–Ω –æ–Ω –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç –≤–∏–¥–µ—Ç—å.

https://www.procustodibus.com/blog/2021/03/wireguard-allowedips-calculator/

–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö –º–∞—Å–æ–∫, –∏—Å–∫–ª—é—á–∞—è —Ç–æ—Ç, —á—Ç–æ –Ω–∞–¥–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º. 

–î–ª—è "–≤—Å–µ –Ω–∞ WG —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ = 0.0.0.0/0" + "–∞ —Ä–∞–±–æ—á–∏–µ –æ—Å—Ç–∞–≤–∏—Ç—å –≤–Ω–µ wg = !—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ=10.10.0.0/16" 

–ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤–æ—Ç —Ç–∞–∫–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è AllowedIPs –≤ –∫–æ–Ω—Ñ–∏–≥ –ø–∏—Ä–∞:
```
AllowedIPs = 10.0.0.0/24, 10.0.2.0/23, 10.0.4.0/22, 10.0.8.0/21, 10.0.16.0/20, 10.0.32.0/19, 10.0.64.0/18, 10.0.128.0/17, 10.1.0.0/16, 10.2.0.0/15, 10.4.0.0/14, 10.8.0.0/13, 10.16.0.0/12, 10.32.0.0/11, 10.64.0.0/10, 10.128.0.0/9
```
–ü—Ä–æ–≤–µ—Ä–∏–ª, —Ä–∞–±–æ—Ç–∞–µ—Ç.

–í—Ä–æ–¥–µ –≤—Å—ë. –ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã - –ø–∏—à–∏—Ç–µ, –±—É–º —Ä–µ—à–∞—Ç—å.
